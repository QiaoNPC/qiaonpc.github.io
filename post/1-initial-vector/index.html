<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Investigate a compromised WordPress server, identify the attack vector, and determine which file was uploaded by the attacker using forensic analysis of the web server structure and logs."><title>1 Initial Vector</title>
<link rel=canonical href=https://qiaonpc.github.io/post/1-initial-vector/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="1 Initial Vector"><meta property='og:description' content="Investigate a compromised WordPress server, identify the attack vector, and determine which file was uploaded by the attacker using forensic analysis of the web server structure and logs."><meta property='og:url' content='https://qiaonpc.github.io/post/1-initial-vector/'><meta property='og:site_name' content><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Forensics'><meta property='article:published_time' content='2025-06-28T00:00:00+00:00'><meta property='article:modified_time' content='2025-06-28T00:00:00+00:00'><meta name=twitter:title content="1 Initial Vector"><meta name=twitter:description content="Investigate a compromised WordPress server, identify the attack vector, and determine which file was uploaded by the attacker using forensic analysis of the web server structure and logs."><link rel="shortcut icon" href=/avatar.jpeg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3941651df2f1975cfd87dfe8c4afb297_324250_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üê±</span></figure><div class=site-meta><h1 class=site-name><a href=/></a></h1><h2 class=site-description>GDGoC APU Cybersecurity Lead | FSEC-SS Vice President & Challenge Creator</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#challenge-information>Challenge Information</a></li><li><a href=#solution>Solution</a><ol><li><a href=#1-initial-clue-wordpress-server>1. <strong>Initial Clue: WordPress Server</strong></a></li><li><a href=#2-focusing-on-plugins>2. <strong>Focusing on Plugins</strong></a></li><li><a href=#3-identifying-a-known-vulnerability>3. <strong>Identifying a Known Vulnerability</strong></a></li><li><a href=#4-understanding-the-exploit>4. <strong>Understanding the Exploit</strong></a></li><li><a href=#5-hunting-for-the-uploaded-file>5. <strong>Hunting for the Uploaded File</strong></a></li><li><a href=#6-final-struggle>6. <strong>Final Struggle</strong></a></li><li><a href=#7-flag>7. <strong>Flag</strong></a></li></ol></li><li><a href=#flag>Flag</a></li><li><a href=#summary>Summary</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/cydes-qualifications-2025/ style=background-color:#0177b8;color:#fff>Cydes Qualifications 2025
</a><a href=/categories/ctf-writeup/ style=background-color:#2a9d8f;color:#fff>CTF Writeup</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/1-initial-vector/>1 Initial Vector</a></h2><h3 class=article-subtitle>Investigate a compromised WordPress server, identify the attack vector, and determine which file was uploaded by the attacker using forensic analysis of the web server structure and logs.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 28, 2025</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h1 id=1-initial-vector---ctf-challenge-writeup>1 Initial Vector - CTF Challenge Writeup</h1><h2 id=challenge-information>Challenge Information</h2><ul><li><strong>Name</strong>: Initial Vector</li><li><strong>Points</strong>: 10</li><li><strong>Category</strong>: Forensic</li><li><strong>Objective</strong>: Investigate a compromised WordPress server, identify the attack vector, and determine which file was uploaded by the attacker using forensic analysis of the web server structure and logs.</li></ul><hr><h2 id=solution>Solution</h2><h3 id=1-initial-clue-wordpress-server>1. <strong>Initial Clue: WordPress Server</strong></h3><ul><li><p>From the description and directory structure, it‚Äôs clear we‚Äôre dealing with a <strong>web server</strong>.</p></li><li><p>Navigated to the common web root: <code>/var/www/html</code> and identified a <strong>WordPress installation</strong>.</p><p><img src=/post/1-initial-vector/wp.png width=1082 height=567 srcset="/post/1-initial-vector/wp_hu9cc35c0b3d19b7b7053893d01ff82fec_220675_480x0_resize_box_3.png 480w, /post/1-initial-vector/wp_hu9cc35c0b3d19b7b7053893d01ff82fec_220675_1024x0_resize_box_3.png 1024w" loading=lazy alt=Wordpress class=gallery-image data-flex-grow=190 data-flex-basis=457px></p></li></ul><hr><h3 id=2-focusing-on-plugins>2. <strong>Focusing on Plugins</strong></h3><ul><li><p>WordPress plugins are often vulnerable, so the next step was to <strong>enumerate installed plugins</strong>.</p></li><li><p>There were only <strong>four plugins</strong>, making enumeration quick and focused.</p><p><img src=/post/1-initial-vector/four%20plugins.png width=1064 height=295 srcset="/post/1-initial-vector/four%20plugins_hucecb3303a472a8ad486136739d1876e4_126974_480x0_resize_box_3.png 480w, /post/1-initial-vector/four%20plugins_hucecb3303a472a8ad486136739d1876e4_126974_1024x0_resize_box_3.png 1024w" loading=lazy alt="Four Plugins Only" class=gallery-image data-flex-grow=360 data-flex-basis=865px></p></li></ul><hr><h3 id=3-identifying-a-known-vulnerability>3. <strong>Identifying a Known Vulnerability</strong></h3><ul><li><p>Only one plugin ‚Äî <strong>Forminator</strong> ‚Äî returned positive results for vulnerabilities.</p></li><li><p>Reference: <a class=link href=https://patchstack.com/database/wordpress/plugin/forminator/vulnerability/wordpress-forminator-plugin-1-24-6-unauthenticated-arbitrary-file-upload-vulnerability target=_blank rel=noopener>Patchstack CVE</a></p></li><li><p>Version <strong>1.24.6</strong> of Forminator is affected by <strong>CVE-2023-4596</strong>, which allows <strong>unauthenticated arbitrary file uploads</strong>.</p><p><img src=/post/1-initial-vector/vulnerable%20formiator.png width=1058 height=770 srcset="/post/1-initial-vector/vulnerable%20formiator_hu831df23b057b7b772703a876c9e44d9c_263447_480x0_resize_box_3.png 480w, /post/1-initial-vector/vulnerable%20formiator_hu831df23b057b7b772703a876c9e44d9c_263447_1024x0_resize_box_3.png 1024w" loading=lazy alt="Vulnerable Forminator" class=gallery-image data-flex-grow=137 data-flex-basis=329px></p></li></ul><hr><h3 id=4-understanding-the-exploit>4. <strong>Understanding the Exploit</strong></h3><ul><li>Found a public Proof-of-Concept exploit script: <a class=link href=https://github.com/E1A/CVE-2023-4596/blob/main/exploit.py target=_blank rel=noopener>GitHub PoC</a></li><li>The script uploads a malicious file via a <code>POST</code> request to <code>wp-admin/admin-ajax.php</code>, then attempts to access it under the <code>wp-content/uploads/YYYY/MM/</code> path.</li><li>Access logs on the server reflected a <strong>similar pattern</strong> of exploitation.</li></ul><hr><h3 id=5-hunting-for-the-uploaded-file>5. <strong>Hunting for the Uploaded File</strong></h3><ul><li><p>The hardest part of this challenge is the md5 hash as I didn&rsquo;t know the format of the md5 hash, but we will go into it later.</p></li><li><p>So after understanding the CVE, it is clear that after a POST request to wp-admin/admin-ajax.php, the script will go on to visit the uploads/2025/month folder for the things they uploaded.</p></li><li><p>At first I didn&rsquo;t really understand the attack, and just submitted the md5 hash of all the files directly under wp-admin/admin-ajax.php but most of what im submitting, at this point, is 192.168.x.x local addresses, which makes it useless as it is already stated that an attacker attacked them, no way the attacker is from local.</p></li><li><p>So I started to pivot to look at other IP addresses. And I submitted random files as i go along, until i found a sus file, which is an image disguised php.</p><p><img src=/post/1-initial-vector/disguised%20png.png width=1074 height=677 srcset="/post/1-initial-vector/disguised%20png_huf0e588d6e51c850834d66a0e0b447fee_274857_480x0_resize_box_3.png 480w, /post/1-initial-vector/disguised%20png_huf0e588d6e51c850834d66a0e0b447fee_274857_1024x0_resize_box_3.png 1024w" loading=lazy alt="Disguied PNG" class=gallery-image data-flex-grow=158 data-flex-basis=380px></p></li><li><p>So i also submitted the md5 hash of the above mentioned file. But it didnt work.</p><p><img src=/post/1-initial-vector/submit%20hash.png width=1066 height=269 srcset="/post/1-initial-vector/submit%20hash_huf1d836b0f4f069c1ebb21685e75346aa_84918_480x0_resize_box_3.png 480w, /post/1-initial-vector/submit%20hash_huf1d836b0f4f069c1ebb21685e75346aa_84918_1024x0_resize_box_3.png 1024w" loading=lazy alt="Submit Hash" class=gallery-image data-flex-grow=396 data-flex-basis=951px></p></li></ul><hr><h3 id=6-final-struggle>6. <strong>Final Struggle</strong></h3><ul><li><p>I eventually gave up and just got the md5 of every file in the uploads folder and upload, and still fail. Which resulted in the following beautiful statistics.</p><p><img src=/post/1-initial-vector/beautiful.png width=1061 height=661 srcset="/post/1-initial-vector/beautiful_hueedc97fcdafe6b0e8f7b0bcc0632c9f9_159612_480x0_resize_box_3.png 480w, /post/1-initial-vector/beautiful_hueedc97fcdafe6b0e8f7b0bcc0632c9f9_159612_1024x0_resize_box_3.png 1024w" loading=lazy alt=Beautiful class=gallery-image data-flex-grow=160 data-flex-basis=385px></p></li></ul><hr><h3 id=7-flag>7. <strong>Flag</strong></h3><ul><li>I then changed my approach and submitted the lowercase md5 hash of the file and got the flag üíÄ</li></ul><hr><h2 id=flag>Flag</h2><p>The flag for this challenge is:<br><code>prelim{CVE-2023-4596_6abb43dc87e07140ba94beafda03baad}</code></p><hr><h2 id=summary>Summary</h2><p>&ldquo;Initial Vector&rdquo; was a forensic challenge centered on real-world web exploitation techniques. By identifying a known plugin vulnerability, analyzing server logs, and tracking uploaded payloads, players practiced both offensive understanding and defensive forensics. The final hurdle was simple yet sneaky ‚Äî the <strong>formatting of the MD5 hash</strong> ‚Äî a subtle but effective way to test attention to detail.</p><hr></section><footer class=article-footer><section class=article-tags><a href=/tags/forensics/>Forensics</a></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Jun 28, 2025 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/0-forensic-sanity-check/><div class=article-details><h2 class=article-title>0 Forensic Sanity Check</h2></div></a></article><article><a href=/post/2-privesc/><div class=article-details><h2 class=article-title>2 Privesc</h2></div></a></article><article><a href=/post/5-persistent/><div class=article-details><h2 class=article-title>5 Persistent</h2></div></a></article><article><a href=/post/get-clawed/><div class=article-details><h2 class=article-title>Get Clawed</h2></div></a></article><article><a href=/post/sustainable-development-goals/><div class=article-details><h2 class=article-title>Sustainable Development Goals</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>