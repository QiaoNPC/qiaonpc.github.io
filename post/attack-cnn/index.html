<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="The goal of the challenge is to perform an adversarial attack against two provided YOLO (You Only Look Once) models. Craft an image such that the two models produce **significantly different predictions**, demonstrating an understanding of adversarial machine learning techniques."><title>attack CNN?</title>
<link rel=canonical href=https://qiaonpc.github.io/post/attack-cnn/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="attack CNN?"><meta property='og:description' content="The goal of the challenge is to perform an adversarial attack against two provided YOLO (You Only Look Once) models. Craft an image such that the two models produce **significantly different predictions**, demonstrating an understanding of adversarial machine learning techniques."><meta property='og:url' content='https://qiaonpc.github.io/post/attack-cnn/'><meta property='og:site_name' content><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Misc'><meta property='article:published_time' content='2025-07-07T00:00:00+00:00'><meta property='article:modified_time' content='2025-07-07T00:00:00+00:00'><meta name=twitter:title content="attack CNN?"><meta name=twitter:description content="The goal of the challenge is to perform an adversarial attack against two provided YOLO (You Only Look Once) models. Craft an image such that the two models produce **significantly different predictions**, demonstrating an understanding of adversarial machine learning techniques."><link rel="shortcut icon" href=/avatar.jpeg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3941651df2f1975cfd87dfe8c4afb297_324250_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üê±</span></figure><div class=site-meta><h1 class=site-name><a href=/></a></h1><h2 class=site-description>Âä†Ê≤πÂä™ÂäõÔºåÂ§ß‰æøË¶ÅÁî®ÂäõÔºåÂ§ß‰∏çÂá∫Êù•Ê≤°ÂÖ≥Á≥ªÔºåËá≥Â∞ëÊîæ‰∏™Â±Å</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#challenge-information>Challenge Information</a></li><li><a href=#solution>Solution</a><ol><li><a href=#1-understanding-the-goal>1. <strong>Understanding the Goal</strong></a></li><li><a href=#2-choosing-the-attack-method>2. <strong>Choosing the Attack Method</strong></a></li><li><a href=#3-executing-the-attack>3. <strong>Executing the Attack</strong></a></li></ol></li><li><a href=#flag>Flag</a></li><li><a href=#summary>Summary</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/no-hack-no-ctf-2025/ style=background-color:#0177b8;color:#fff>No Hack No CTF 2025
</a><a href=/categories/ctf-writeup/ style=background-color:#2a9d8f;color:#fff>CTF Writeup</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/attack-cnn/>attack CNN?</a></h2><h3 class=article-subtitle>The goal of the challenge is to perform an adversarial attack against two provided YOLO (You Only Look Once) models. Craft an image such that the two models produce **significantly different predictions**, demonstrating an understanding of adversarial machine learning techniques.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 07, 2025</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h1 id=attack-cnn---ctf-challenge-writeup>attack CNN? - CTF Challenge Writeup</h1><h2 id=challenge-information>Challenge Information</h2><ul><li><strong>Name</strong>: attack CNN?</li><li><strong>Points</strong>: 10</li><li><strong>Category</strong>: Misc</li><li><strong>Objective</strong>: Perform an adversarial attack against two provided YOLO (You Only Look Once) models. Craft an image such that the two models produce <strong>significantly different predictions</strong>, demonstrating an understanding of adversarial machine learning techniques.</li></ul><hr><h2 id=solution>Solution</h2><h3 id=1-understanding-the-goal>1. <strong>Understanding the Goal</strong></h3><ul><li><p>Given two object detection models:</p><ul><li><code>yolo_v8.pt</code></li><li><code>yolo_v10.pt</code></li></ul></li><li><p>The objective is to <strong>generate a single adversarial image</strong> that causes the models to output different results under the following conditions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>different_prediction</span> <span class=o>=</span> <span class=n>result_v8</span><span class=p>[</span><span class=s2>&#34;class_name&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>result_v10</span><span class=p>[</span><span class=s2>&#34;class_name&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>confidence_gap</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>result_v8</span><span class=p>[</span><span class=s2>&#34;confidence&#34;</span><span class=p>]</span> <span class=o>-</span> <span class=n>result_v10</span><span class=p>[</span><span class=s2>&#34;confidence&#34;</span><span class=p>])</span> <span class=o>&gt;=</span> <span class=mf>0.4</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Both conditions must be satisfied to consider the attack successful.</p></li></ul><hr><h3 id=2-choosing-the-attack-method>2. <strong>Choosing the Attack Method</strong></h3><ul><li><p>This is a classic use case for <strong>adversarial machine learning</strong> techniques, targeting deep neural networks.</p></li><li><p>Two common attacks were considered:</p><ul><li><strong>FGSM (Fast Gradient Sign Method)</strong> ‚Äì faster, simpler</li><li><strong>PGD (Projected Gradient Descent)</strong> ‚Äì more effective but slower</li></ul></li><li><p>For this challenge, <strong>PGD was used</strong> for better perturbation control and higher attack success rate.</p></li></ul><hr><h3 id=3-executing-the-attack>3. <strong>Executing the Attack</strong></h3><ul><li><p>Loaded both YOLO models using an appropriate framework (e.g., PyTorch + Ultralytics YOLOv8).</p></li><li><p>Started from a base image and applied the <strong>PGD adversarial attack</strong>, modifying the image iteratively to:</p><ul><li><p>Change the prediction <strong>class name</strong></p></li><li><p>Create a <strong>‚â• 0.4 confidence gap</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>ultralytics</span> <span class=kn>import</span> <span class=n>YOLO</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>device</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>(</span><span class=s2>&#34;cuda&#34;</span> <span class=k>if</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&#34;cpu&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model_v8</span> <span class=o>=</span> <span class=n>YOLO</span><span class=p>(</span><span class=s2>&#34;yolo_v8.pt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model_v10</span> <span class=o>=</span> <span class=n>YOLO</span><span class=p>(</span><span class=s2>&#34;yolo_v10.pt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_image</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>640</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>image_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>(</span><span class=n>size</span><span class=p>,</span> <span class=n>size</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_BGR2RGB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>img</span> <span class=o>/</span> <span class=mf>255.0</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>torch</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span><span class=o>.</span><span class=n>permute</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>unsqueeze</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>img</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@torch.no_grad</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_top_prediction</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>image_tensor</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>image_tensor</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>boxes</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>boxes</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>boxes</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>boxes</span><span class=o>.</span><span class=n>cls</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;class&#34;</span><span class=p>:</span> <span class=s2>&#34;None&#34;</span><span class=p>,</span> <span class=s2>&#34;confidence&#34;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>confs</span> <span class=o>=</span> <span class=n>boxes</span><span class=o>.</span><span class=n>conf</span><span class=o>.</span><span class=n>cpu</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>classes</span> <span class=o>=</span> <span class=n>boxes</span><span class=o>.</span><span class=n>cls</span><span class=o>.</span><span class=n>cpu</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>top</span> <span class=o>=</span> <span class=n>confs</span><span class=o>.</span><span class=n>argmax</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;class&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>classes</span><span class=p>[</span><span class=n>top</span><span class=p>])),</span> <span class=s2>&#34;confidence&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>confs</span><span class=p>[</span><span class=n>top</span><span class=p>])}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add_random_start</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>epsilon</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>noise</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>image</span><span class=p>)</span><span class=o>.</span><span class=n>uniform_</span><span class=p>(</span><span class=o>-</span><span class=n>epsilon</span><span class=p>,</span> <span class=n>epsilon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>image</span> <span class=o>+</span> <span class=n>noise</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pgd_with_dummy_grad</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>epsilon</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>iters</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ori</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>iters</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>requires_grad_</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>dummy_loss</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>dummy_loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>grad</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>grad</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>image</span> <span class=o>+</span> <span class=n>alpha</span> <span class=o>*</span> <span class=n>grad</span><span class=o>.</span><span class=n>sign</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>delta</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>image</span> <span class=o>-</span> <span class=n>ori</span><span class=p>,</span> <span class=nb>min</span><span class=o>=-</span><span class=n>epsilon</span><span class=p>,</span> <span class=nb>max</span><span class=o>=</span><span class=n>epsilon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>image</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>clamp</span><span class=p>(</span><span class=n>ori</span> <span class=o>+</span> <span class=n>delta</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_pgd_ctf</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>epsilon</span><span class=o>=</span><span class=mf>0.03</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.005</span><span class=p>,</span> <span class=n>iters</span><span class=o>=</span><span class=mi>40</span><span class=p>,</span> <span class=n>max_restarts</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>out_dir</span><span class=o>=</span><span class=s2>&#34;pgd_ctf_out&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>out_dir</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>base</span> <span class=o>=</span> <span class=n>load_image</span><span class=p>(</span><span class=n>image_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>max_restarts</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=n>add_random_start</span><span class=p>(</span><span class=n>base</span><span class=o>.</span><span class=n>clone</span><span class=p>(),</span> <span class=n>epsilon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>adv</span> <span class=o>=</span> <span class=n>pgd_with_dummy_grad</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>epsilon</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>iters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result_v10</span> <span class=o>=</span> <span class=n>get_top_prediction</span><span class=p>(</span><span class=n>model_v10</span><span class=p>,</span> <span class=n>adv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result_v8</span> <span class=o>=</span> <span class=n>get_top_prediction</span><span class=p>(</span><span class=n>model_v8</span><span class=p>,</span> <span class=n>adv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>] v10: </span><span class=si>{</span><span class=n>result_v10</span><span class=si>}</span><span class=s2>, v8: </span><span class=si>{</span><span class=n>result_v8</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>result_v8</span><span class=p>[</span><span class=s2>&#34;class&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>result_v10</span><span class=p>[</span><span class=s2>&#34;class&#34;</span><span class=p>]</span> <span class=ow>and</span> <span class=nb>abs</span><span class=p>(</span><span class=n>result_v8</span><span class=p>[</span><span class=s2>&#34;confidence&#34;</span><span class=p>]</span> <span class=o>-</span> <span class=n>result_v10</span><span class=p>[</span><span class=s2>&#34;confidence&#34;</span><span class=p>])</span> <span class=o>&gt;=</span> <span class=mf>0.4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=o>=</span> <span class=n>adv</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span><span class=o>.</span><span class=n>permute</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>cpu</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>()</span> <span class=o>*</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_RGB2BGR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>out_dir</span><span class=si>}</span><span class=s2>/pgd_success_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>.png&#34;</span><span class=p>,</span> <span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;‚úÖ CTF condition met.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;‚ùå CTF condition not met after max_restarts.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>run_pgd_ctf</span><span class=p>(</span><span class=s2>&#34;car.png&#34;</span><span class=p>,</span> <span class=n>epsilon</span><span class=o>=</span><span class=mf>0.03</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.005</span><span class=p>,</span> <span class=n>iters</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li><li><p>The attack was successful when the altered image caused the two models to disagree both in classification and confidence, satisfying the provided formula.</p><p><img src=/post/attack-cnn/flag.png width=1148 height=763 srcset="/post/attack-cnn/flag_hue859d4d380f19cb6a0eeb5f76259ffae_891640_480x0_resize_box_3.png 480w, /post/attack-cnn/flag_hue859d4d380f19cb6a0eeb5f76259ffae_891640_1024x0_resize_box_3.png 1024w" loading=lazy alt=Flag class=gallery-image data-flex-grow=150 data-flex-basis=361px></p></li></ul><hr><h2 id=flag>Flag</h2><p>The flag for this challenge is: <code>NHNC{you_kn0w_h0w_t0_d0_adv3rs3ria1_attack}</code></p><hr><h2 id=summary>Summary</h2><p>The &ldquo;attack CNN?&rdquo; challenge introduces players to the field of <strong>adversarial AI</strong>, focusing on image-based attacks against neural networks. By crafting subtle perturbations, players learn how seemingly minor changes can cause significant shifts in deep learning model outputs ‚Äî an essential skill in both AI security and red-teaming contexts.</p><hr></section><footer class=article-footer><section class=article-tags><a href=/tags/misc/>Misc</a></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Jul 07, 2025 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/0-zero/><div class=article-details><h2 class=article-title>0 - Zero</h2></div></a></article><article><a href=/post/1-one/><div class=article-details><h2 class=article-title>1 - One</h2></div></a></article><article><a href=/post/10-ten/><div class=article-details><h2 class=article-title>10 - Ten</h2></div></a></article><article><a href=/post/11-eleven/><div class=article-details><h2 class=article-title>11 - Eleven</h2></div></a></article><article><a href=/post/12-twelve/><div class=article-details><h2 class=article-title>12 - Twelve</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>